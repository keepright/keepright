// this file includes derived classes from various libraries
// find the readable version of this file in the keepright svn repository
// JS code compressed by UglifyJS http://marijnhaverbeke.nl//uglifyjs

/* 
OpenLayers

Copyright (c) 2006-2008 MetaCarta, Inc., published under the Clear BSD
license.  See http://svn.openlayers.org/trunk/openlayers/license.txt for the
full text of the license.


JS Outline

Fully accessible collapsible outlines. JavaScript code
copyright 2007, Boutell.Com, Inc.

See http://www.boutell.com/newfaq/ for more information.

Permission granted to use, republish, sell and otherwise
benefit from this code as you see fit, provided you keep
this notice intact. You may remove comments below this line.


Tristate Checkbox

v 0.9.2 19th Dec 2008
By Shams Mahmood
http://shamsmi.blogspot.com 
*/

function init(){map=new OpenLayers.Map("map",{controls:[new OpenLayers.Control.Navigation,new OpenLayers.Control.PanZoomBar,new OpenLayers.Control.LayerSwitcher,new OpenLayers.Control.Attribution],maxExtent:new OpenLayers.Bounds(-20037508,-20037508,20037508,20037508),maxResolution:156543,numZoomLevels:20,units:"m",projection:new OpenLayers.Projection("EPSG:900913"),displayProjection:new OpenLayers.Projection("EPSG:4326")});var a=new OpenLayers.Layer.OSM.Mapnik("Mapnik",{attribution:'&copy; <a href="http://www.openstreetmap.org">OpenStreetMap</a> contributors'});map.addLayer(a);var b=new OpenLayers.Layer.OSM.CycleMap("OSM Cycle Map",{attribution:'&copy; <a href="http://www.openstreetmap.org">OpenStreetMap</a> contributors'});map.addLayer(b),pois=new OpenLayers.Layer.myText("Errors on Nodes",{location:poisURL,projection:new OpenLayers.Projection("EPSG:4326")}),map.addLayer(pois);var c=new OpenLayers.LonLat(lon,lat).transform(new OpenLayers.Projection("EPSG:4326"),map.getProjectionObject());map.setCenter(c,zoom),plnk=new OpenLayers.Control.myPermalink,plnk.displayClass="olControlPermalink",map.addControl(plnk),map.events.register("moveend",map,function(){var a=this.getCenter().clone(),b=a.transform(this.getProjectionObject(),new OpenLayers.Projection("EPSG:4326"));document.myform.lat.value=b.lat,document.myform.lon.value=b.lon,document.myform.zoom.value=this.getZoom(),updateCookie(),updateLinks(),pois.loadText()}),updateCookie(),updateLinks()}function saveComment(a,b,c){var d=document["errfrm_"+a+"_"+b];repaintIcon(a,b,d.st,c),d.submit(),closeBubble(a,b)}function repaintIcon(a,b,c,d){for(var e=pois.error_ids[a][b],f=0,g=pois.features.length,h=null;g>f&&null==h;)pois.features[f].id==e&&(h=pois.features[f]),f++;c[0].checked?h.marker.icon.setUrl("img/zap"+d+".png"):c[1].checked?h.marker.icon.setUrl("img/zapangel.png"):c[2].checked&&h.marker.icon.setUrl("img/zapdevil.png")}function closeBubble(a,b){for(var c=pois.error_ids[a][b],d=0,e=pois.features.length,f=null;e>d&&null==f;)pois.features[d].id==c&&(f=pois.features[d]),d++;f.marker.events.triggerEvent("mousedown")}function set_checkboxes(a){if(0==a||9==a)for(var b=0;b<document.myform.elements.length;++b){var c=document.myform.elements[b];"checkbox"==c.type&&null!=c.name.match(/ch[0-9]+/)&&(c.checked=a?!0:!1)}else{5==a&&(displayedTypes=new Array("ch40","ch70","ch90","ch130","ch191","ch195","ch196","ch201","ch202","ch203","ch204","ch205","ch206","ch207","ch208","ch231","ch232","ch291","ch292","ch293","ch294","ch311","ch312","ch313","ch380","ch401","ch402"));for(var b=0;b<document.myform.elements.length;++b){var c=document.myform.elements[b];"checkbox"==c.type&&null!=c.name.match(/ch[0-9]+/)&&(c.checked=-1!=displayedTypes.indexOf(c.name)?!0:!1)}}for(b=1;b<=document.myform.number_of_tristate_checkboxes.value;b++){var d="tristateBox"+b+".Img",e=getFieldAndContainerIds(d),f=getAllCheckboxesInContainer(e[1]),g=document.getElementById(e[0]);updateStateAndImage(f,g,d)}plnk.updateLink()}function updateCookie(){var a=map.getCenter().clone(),b=a.transform(map.getProjectionObject(),new OpenLayers.Projection("EPSG:4326"));setCookie(b.lon,b.lat,map.getZoom(),getURL_checkboxes(!1,!1),document.myform.lang.value)}function setCookie(a,b,c,d,e){var f=new Date;f.setYear(f.getFullYear()+10),document.cookie="keepright_cookie="+a+"|"+b+"|"+c+"|"+d+"|"+e+"; expires="+f.toGMTString()}function setLang(a){if(document.cookie.length>0){var b=document.cookie.split("|");b.length>=4?(b[4].indexOf(";")>0?b[4]=a+b[4].substr(b[4].indexOf(";")):b[4]=a,document.cookie=b.join("|")):setCookie("","","","",a)}else setCookie("","","","",a)}function updateLinks(){var a=map.getCenter().clone(),b=a.transform(map.getProjectionObject(),new OpenLayers.Projection("EPSG:4326")),c=document.getElementById("editierlink");c.href="http://www.openstreetmap.org/edit?lat="+b.lat+"&lon="+b.lon+"&zoom="+map.getZoom();var d=document.getElementById("rsslink"),e=document.getElementById("gpxlink"),f=document.getElementById("geojsonlink"),g=map.getExtent(),h=g.transform(map.getProjectionObject(),new OpenLayers.Projection("EPSG:4326")),i="export.php?format=",j=getURL_checkboxes()+"&left="+h.left+"&bottom="+h.bottom+"&right="+h.right+"&top="+h.top;d.href=i+"rss&"+j,e.href=i+"gpx&"+j,f.href=i+"geojson&"+j}function checkbox_click(){pois.loadText(),plnk.updateLink(),updateCookie(),updateLinks()}function getURL_checkboxes(a,b){var c="";void 0===a&&(a=!0),void 0===b&&(b=!0),c=a?"ch=0":"0";for(var d=0;d<document.myform.elements.length;++d){var e=document.myform.elements[d];"checkbox"==e.type&&null!=e.name.match(/ch[0-9]+/)&&e.checked==b&&(c+=","+e.name.substr(2))}return c}function outlineInit(){for(var a=outlineGetTopLevelLists(),b=0;b<a.length;b++)outlineInitOutline(a[b])}function outlineInitOutline(a){for(var b=a.childNodes,c=0;c<b.length;c++){var d=b[c];"LI"==d.nodeName&&outlineInitItem(d)}}function outlineInitItem(a){for(var b=a.childNodes,c=!1,d=new Array,e=0;e<b.length;e++){var f=b[e];"UL"==f.nodeName&&(f.style.display="none",outlineInitOutline(f),c=!0,d[d.length]=f)}if(c){a.style.cursor="pointer";var g=outlineItems.length;outlineItems[g]=a;var h=document.createElement("span");h.innerHTML="<a href='#' onClick='outlineItemClickByOffset("+g+"); return false' class='olink'><img class='oimg' alt='Open' src='img/oopen.png'></a>",a.insertBefore(h,b[0]),a.onclick=outlineItemClick}}function outlineGetTarget(a){var b;a||(a=window.event),a.cancelBubble=!0,a.stopPropagation&&a.stopPropagation();var b=a.target;return b||(b=a.srcElement),b}function outlineItemClickByOffset(a){outlineItemClickBody(outlineItems[a])}function outlineItemClick(a){target=outlineGetTarget(a),outlineItemClickBody(target)}function outlineItemClickBody(a){for(var b=!0,c=a.childNodes,d=!1,e=0;e<c.length;e++){var f=c[e];"UL"==f.nodeName&&("none"==f.style.display?f.style.display="block":(f.style.display="none",b=!1),d=!0)}if(d){var g=outlineGetImg(a);b?(g.src="img/oclose.png",g.alt="Close"):(g.src="img/oopen.png",g.alt="Open")}}function outlineGetImg(a){return outlineGetDescendantWithClassName(a,"oimg")}function outlineGetDescendantWithClassName(a,b){var e,c=a.childNodes,d=c.length,f=new RegExp("(^| )"+b+"( |$)");for(e=0;d>e;e++){if(f.test(c[e].className))return c[e];var g=outlineGetDescendantWithClassName(c[e],b);if(g)return g}return null}function outlineGetTopLevelLists(){var d,a="outline",b=document.getElementsByTagName("ul"),c=b.length,e=new RegExp("(^| )"+a+"( |$)"),f=new Array;for(d=0;c>d;d++)e.test(b[d].className)&&f.push(b[d]);return f}function getNextStateFromValue(a){return a==STATE_SOME?STATE_ALL:a==STATE_ALL?STATE_NONE:STATE_SOME}function getStateFromValue(a,b){return a==STATE_SOME?b?INTERMEDIATE_HILI:INTERMEDIATE_NORM:a==STATE_ALL?b?CHECKED_HILI:CHECKED_NORM:b?UNCHECKED_HILI:UNCHECKED_NORM}function getFieldAndContainerIds(a){var b=a.substring(0,a.length-".Img".length),c=document.getElementById(b+".Field").value,d=document.getElementById(b+".Container"),e="";return d&&(e=d.value),[c,e]}function getAllCheckboxesInContainer(a){if(""==a)return[];for(var b=document.getElementById(a),c=b.getElementsByTagName("input"),d=new Array,e=0,f=0;f<c.length;f++){var g=c[f];"checkbox"==g.type&&(d[e++]=g)}return d}function selectOrUnselectBoxes(a,b){for(var c in a)a[c].checked=b}function areAllBoxesInGivenCheckedState(a,b){for(var c=!0,d=0;d<a.length;d++)if(a[d].checked!=b){c=!1;break}return c}function replaceImage(a,b){var c=document.getElementById(a);c.src!=b&&(c.src=b)}function mouseOverOutOfImage(a,b){var c=getFieldAndContainerIds(a),d=document.getElementById(c[0]),e=getStateFromValue(d.value,b);return DEFAULT_CONFIG[e]}function onMouseOverImage(a){return function(){var b=mouseOverOutOfImage(a,!0);replaceImage(a,b)}}function onMouseOutImage(a){return function(){var b=mouseOverOutOfImage(a,!1);replaceImage(a,b)}}function onTristateImageClick(a,b,c){return function(){var d=getFieldAndContainerIds(a),e=document.getElementById(d[0]),f=getNextStateFromValue(e.value);if(b||f!=STATE_SOME||(f=getNextStateFromValue(f)),e.value=f,""!=d[1]){var g=getAllCheckboxesInContainer(d[1]);selectOrUnselectBoxes(g,f==STATE_ALL)}var h=mouseOverOutOfImage(a,!0);replaceImage(a,h),c()}}function onCheckboxClick(a,b){return function(){var b=getFieldAndContainerIds(a),c=getAllCheckboxesInContainer(b[1]),d=document.getElementById(b[0]);updateStateAndImage(c,d,a)}}function updateStateAndImage(a,b,c){if(a.length>0){var d=areAllBoxesInGivenCheckedState(a,!0),e=areAllBoxesInGivenCheckedState(a,!1);d?b.value=STATE_ALL:e?b.value=STATE_NONE:b.value=STATE_SOME}var f=mouseOverOutOfImage(c,!1);replaceImage(c,f)}function createHiddenStateField(a,b){var c=document.createElement("input");return c.id=b,c.type="hidden",c.value=STATE_NONE,a.appendChild(c),c}function createTriStateImageNode(a,b,c,d){var e=new Image;e.id=b,e.src=DEFAULT_CONFIG[UNCHECKED_NORM],a.appendChild(e),a.addEventListener?(a.addEventListener("mouseover",onMouseOverImage(e.id),!1),a.addEventListener("mouseout",onMouseOutImage(e.id),!1),a.addEventListener("click",onTristateImageClick(e.id,c,d),!1)):a.attachEvent&&(a.attachEvent("onmouseover",onMouseOverImage(e.id)),a.attachEvent("onmouseout",onMouseOutImage(e.id)),a.attachEvent("onclick",onTristateImageClick(e.id,c,d)))}function createFieldNameHiddenField(a,b,c){var d=document.createElement("input");d.id=b,d.type="hidden",d.value=c,a.appendChild(d)}function createContainerNameHiddenField(a,b,c){var d=document.createElement("input");d.id=b,d.type="hidden",d.value=c,a.appendChild(d)}function attachOnclickEventsToDependentBoxes(a,b){var c=getAllCheckboxesInContainer(a);for(var d in c){var e=c[d];e.addEventListener?e.addEventListener("click",onCheckboxClick(b,e.id),!1):e.attachEvent&&e.attachEvent("onclick",onCheckboxClick(b,e.id))}return c}function initTriStateCheckBox(a,b,c,d){var e=document.getElementById(a),f=b,g=a+".Value";c&&(f="",g=b);var h=e.childNodes[0];e.removeChild(h);var i=document.getElementById(g);c||(i=createHiddenStateField(e,g));var j=a+".Img";createTriStateImageNode(e,j,c,d);var k=a+".Field";if(createFieldNameHiddenField(e,k,g),!c){var l=a+".Container";createContainerNameHiddenField(e,l,f)}e.appendChild(h);var m=attachOnclickEventsToDependentBoxes(f,j);updateStateAndImage(m,i,j)}OpenLayers.Control.myPermalink=OpenLayers.Class(OpenLayers.Control,{argParserClass:OpenLayers.Control.ArgParser,element:null,base:"",displayProjection:null,initialize:function(a,b,c){OpenLayers.Control.prototype.initialize.apply(this,[c]),this.element=OpenLayers.Util.getElement(a),this.base=b||document.location.href},destroy:function(){this.element.parentNode==this.div&&this.div.removeChild(this.element),this.element=null,this.map.events.unregister("moveend",this,this.updateLink),OpenLayers.Control.prototype.destroy.apply(this,arguments)},setMap:function(a){OpenLayers.Control.prototype.setMap.apply(this,arguments);for(var b=0,c=this.map.controls.length;c>b;b++){var d=this.map.controls[b];if(d.CLASS_NAME==this.argParserClass.CLASS_NAME){d.displayProjection!=this.displayProjection&&(this.displayProjection=d.displayProjection);break}}b==this.map.controls.length&&this.map.addControl(new this.argParserClass({displayProjection:this.displayProjection}))},draw:function(){return OpenLayers.Control.prototype.draw.apply(this,arguments),this.element||(this.div.className=this.displayClass,this.element=document.createElement("a"),this.element.innerHTML=OpenLayers.i18n("permalink"),this.element.href="",this.div.appendChild(this.element)),this.map.events.on({moveend:this.updateLink,changelayer:this.updateLink,changebaselayer:this.updateLink,scope:this}),this.updateLink(),this.div},updateLink:function(){var a=this.base;-1!=a.indexOf("?")&&(a=a.substring(0,a.indexOf("?"))),a+="?"+OpenLayers.Util.getParameterString(this.createParams()),this.element.href=a},createParams:function(a,b,c){a=a||this.map.getCenter();var d=OpenLayers.Util.getParameters(this.base);if(a){d.zoom=b||this.map.getZoom();var e=a.lat,f=a.lon;if(this.displayProjection){var g=OpenLayers.Projection.transform({x:f,y:e},this.map.getProjectionObject(),this.displayProjection);f=g.x,e=g.y}d.lat=Math.round(1e5*e)/1e5,d.lon=Math.round(1e5*f)/1e5,c=c||this.map.layers,d.layers="";for(var h=0,i=c.length;i>h;h++){var j=c[h];j.isBaseLayer?d.layers+=j==this.map.baseLayer?"B":"0":d.layers+=j.getVisibility()?"T":"F"}}return d.ch=getURL_checkboxes(!1),d.show_ign=document.myform.show_ign.checked?1:0,d.show_tmpign=document.myform.show_tmpign.checked?1:0,d},CLASS_NAME:"OpenLayers.Control.myPermalink"}),OpenLayers.Format.myTextFormat=OpenLayers.Class(OpenLayers.Format,{initialize:function(a){OpenLayers.Format.prototype.initialize.apply(this,[a])},read:function(a){for(var b=a.split("\n"),c=[],d=1;d<b.length-1;d++){var e=b[d].replace(/^\s*/,"").replace(/\s*$/,"");if("#"!=e.charAt(0)){var f=e.split(" "),g=new OpenLayers.Geometry.Point(0,0),h={},i={};g.y=parseFloat(f[0]),h.lat=g.y,g.x=parseFloat(f[1]),h.lon=g.x,h.error_name=f[2],h.error_type=f[3],h.object_type=f[4],h.object_type_EN=f[5],h.object_id=f[6],h.object_timestamp=f[7],h.user_name=f[8],h.schema=f[9],h.error_id=f[10],h.description=f[11],h.comment=f[12],h.state=f[13],i.externalGraphic=f[14];var m=f[15].split(",");i.graphicWidth=parseFloat(m[0]),i.graphicHeight=parseFloat(m[1]);var n=f[16].split(",");if(i.graphicXOffset=parseFloat(n[0]),i.graphicYOffset=parseFloat(n[1]),h.partner_objects=f[17],f.length>1){this.internalProjection&&this.externalProjection&&g.transform(this.externalProjection,this.internalProjection);var o=new OpenLayers.Feature.Vector(g,h,i);c.push(o)}}}return c},CLASS_NAME:"OpenLayers.Format.myTextFormat"}),OpenLayers.Layer.myText=OpenLayers.Class(OpenLayers.Layer.Markers,{location:null,features:null,formatOptions:null,selectedFeature:null,activePopup:null,activeFeature:null,clicked:!1,error_ids:{},initialize:function(a,b){OpenLayers.Layer.Markers.prototype.initialize.apply(this,arguments),this.features=new Array},destroy:function(){OpenLayers.Layer.Markers.prototype.destroy.apply(this,arguments),this.clearFeatures(),this.features=null},loadText:function(){if(null!=this.location){var a="points.php?lat="+document.myform.lat.value+"&lon="+document.myform.lon.value+"&zoom="+document.myform.zoom.value+"&show_ign="+(document.myform.show_ign.checked?1:0)+"&show_tmpign="+(document.myform.show_tmpign.checked?1:0)+"&lang="+document.myform.lang.value+"&"+getURL_checkboxes(),b=function(a){this.events.triggerEvent("loadend")};this.events.triggerEvent("loadstart"),OpenLayers.Request.GET({url:a,success:this.parseData,failure:b,scope:this}),this.loaded=!0}},moveTo:function(a,b,c){OpenLayers.Layer.Markers.prototype.moveTo.apply(this,arguments),this.visibility&&!this.loaded&&this.loadText()},parseData:function(a){function b(a,b){var d,e,f,c={};if(d=new OpenLayers.LonLat(b.geometry.x,b.geometry.y),b.style.graphicWidth&&b.style.graphicHeight&&(e=new OpenLayers.Size(b.style.graphicWidth,b.style.graphicHeight)),void 0!==b.style.graphicXOffset&&void 0!==b.style.graphicYOffset&&(f=new OpenLayers.Pixel(b.style.graphicXOffset,b.style.graphicYOffset)),null!=b.style.externalGraphic?c.icon=new OpenLayers.Icon(b.style.externalGraphic,e,f):(c.icon=OpenLayers.Marker.defaultIcon(),null!=e&&c.icon.setSize(e)),null==b.attributes.comment&&(b.attributes.comment=""),null!=b.attributes.error_id){var g=b.attributes.error_name,h=b.attributes.error_type,i=b.attributes.schema,j=b.attributes.error_id,k=b.attributes.object_type,l=b.attributes.object_type_EN,m=b.attributes.object_id,n=b.attributes.object_timestamp,o=b.attributes.user_name,p=b.attributes.description,q=b.attributes.comment.replace(/<br>/g,"\n"),r=b.attributes.state,s=b.attributes.lat,t=b.attributes.lon,u=b.attributes.partner_objects;u="undefined"==typeof u?"":","+u,c.popupContentHTML="<h5>"+g+", "+k+' <a href="http://www.openstreetmap.org/browse/'+l+"/"+m+'" target="_blank">'+m+'</a></h5><p class="p1">'+p+'</p><p class="p2">'+txt4+' <a href="http://localhost:8111/load_and_zoom?left='+(t-.001)+"&right="+(t- -.001)+"&top="+(s- -.001)+"&bottom="+(s-.001)+"&select="+l+m+u+'&zoom_mode=download" target="hiddenIframe" title="'+txt6+'">'+txt5+'</a> <a href="http://www.openstreetmap.org/edit?lat='+s+"&lon="+t+'&zoom=18" target="_blank">'+txt7+'</a> <a href="http://www.openstreetmap.org/edit?editor=id&lat='+s+"&lon="+t+"&zoom=18&"+l+"="+m+'" target="_blank">'+txt16+'</a> <a href="http://level0.osmz.ru/?url='+l+"/"+m+'" target="_blank">Level0</a></p><form class="p3" name="errfrm_'+i+"_"+j+'" target="hiddenIframe" method="get" action="comment.php"><input type="radio" id="st_'+i+"_"+j+'_n" '+("ignore_t"!=r&&"ignore"!=r?'checked="checked"':"")+' name="st" value=""><label for="st_'+i+"_"+j+'_n">'+txt8+'</label><br><input type="radio" id="st_'+i+"_"+j+'_t" '+("ignore_t"==r?'checked="checked"':"")+' name="st" value="ignore_t"><label for="st_'+i+"_"+j+'_t">'+txt9+'</label><br><input type="radio" id="st_'+i+"_"+j+'_i" '+("ignore"==r?'checked="checked"':"")+' name="st" value="ignore"><label for="st_'+i+"_"+j+'_i">'+txt10+'</label><br><span style="white-space:nowrap;"><textarea cols="25" rows="2" name="co">'+q+'</textarea><input type="hidden" name="schema" value="'+i+'"><input type="hidden" name="id" value="'+j+'"><input type="button" value="'+txt11+'" onClick="javascript:saveComment('+i+", "+j+", "+h+');"><input type="button" value="'+txt12+'" onClick="javascript:closeBubble('+i+", "+j+');"></form><small><br>'+txt13+"</span>"+txt14+'<a href="report_map.php?schema='+i+"&error="+j+'">'+j+"</a><br>"+txt15+" "+k+': <a href="http://www.openstreetmap.org/user/'+o+'" target="_blank">'+o+"</a> "+n+"</small>"}c.overflow=b.attributes.overflow||"auto";var v=new OpenLayers.Feature(a,d,c);v.popupClass=OpenLayers.Popup.FramedCloud,a.features.push(v);var w=v.createMarker();return null!=b.attributes.error_id&&(w.events.register("mousedown",v,a.onClickHandler),w.events.register("mouseover",v,a.onHOverHandler),w.events.register("mouseout",v,a.onOutHandler)),a.addMarker(w),i==document.myform.highlight_schema.value&&j==document.myform.highlight_error_id.value&&w.events.triggerEvent("mousedown"),v.id}var c=a.responseText,d={};OpenLayers.Util.extend(d,this.formatOptions),this.map&&!this.projection.equals(this.map.getProjectionObject())&&(d.externalProjection=this.projection,d.internalProjection=this.map.getProjectionObject());for(var h,i,e=new OpenLayers.Format.myTextFormat(d),f=e.read(c),g={},j=0,k=f.length;k>j;j++)h=f[j].attributes.error_id,i=f[j].attributes.schema,void 0!=h&&null!=h&&(void 0==this.error_ids[i]&&(this.error_ids[i]={}),this.error_ids[i][h]||(this.error_ids[i][h]=b(this,f[j])),void 0==g[i]&&(g[i]={}),g[i][h]=!0);var l=null;for(var m in this.error_ids)for(var n in this.error_ids[m])if(void 0==g[m]||!g[m][n]){l=this.error_ids[m][n];for(var o=null,p=0,k=this.features.length;k>p&&null==o;)this.features[p].id==l&&(o=this.features[p]),p++;if(null!=o){OpenLayers.Util.removeItem(this.features,o);for(var q=null,r=0,k=this.markers.length;k>r&&null==q;)this.markers[r].events.element.id==o.marker.events.element.id&&(q=this.markers[r]),r++;OpenLayers.Util.removeItem(this.markers,q),o.destroy(),o=null}delete this.error_ids[m][n]}this.events.triggerEvent("loadend")},onClickHandler:function(a){this.activeFeature=this,this.clicked&&this.activePopup==this.popup?(this.activePopup.hide(),this.clicked=!1):(this.clicked&&!this.activePopup==this.popup||!this.clicked)&&(null!=this.activePopup&&this.activePopup.hide(),null==this.popup?(this.popup=this.createPopup(),this.popup.autoSize=!1,this.popup.panMapIfOutOfView=!1,this.popup.setSize(new OpenLayers.Size(380,380)),map.addPopup(this.popup)):this.popup.toggle(),this.activePopup=this.popup,this.clicked=!0),OpenLayers.Event.stop(a)},onHOverHandler:function(a){this.clicked||(null!=this.activePopup&&this.activePopup.hide(),null==this.popup?(this.popup=this.createPopup(),this.popup.autoSize=!1,this.popup.panMapIfOutOfView=!1,this.popup.setSize(new OpenLayers.Size(380,380)),map.addPopup(this.popup)):this.popup.toggle(),this.activePopup=this.popup),OpenLayers.Event.stop(a)},onOutHandler:function(a){this.clicked||null==this.activePopup||this.activePopup.hide(),OpenLayers.Event.stop(a)},clearFeatures:function(){if(null!=this.features)for(;this.features.length>0;){var a=this.features[0];OpenLayers.Util.removeItem(this.features,a),a.destroy()}},CLASS_NAME:"OpenLayers.Layer.myText"});var outlineItems=new Array,STATE_NONE=0,STATE_SOME=1,STATE_ALL=2,UNCHECKED_NORM="UNCHECKED_NORM",UNCHECKED_HILI="UNCHECKED_HILI",INTERMEDIATE_NORM="INTERMEDIATE_NORM",INTERMEDIATE_HILI="INTERMEDIATE_HILI",CHECKED_NORM="CHECKED_NORM",CHECKED_HILI="CHECKED_HILI",DEFAULT_CONFIG={UNCHECKED_NORM:"http://keepright.ipax.at/img/unchecked.gif",UNCHECKED_HILI:"http://keepright.ipax.at/img/unchecked_highlighted.gif",INTERMEDIATE_NORM:"http://keepright.ipax.at/img/intermediate.gif",INTERMEDIATE_HILI:"http://keepright.ipax.at/img/intermediate_highlighted.gif",CHECKED_NORM:"http://keepright.ipax.at/img/checked.gif",CHECKED_HILI:"http://keepright.ipax.at/img/checked_highlighted.gif"};